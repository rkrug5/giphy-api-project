<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Giphy App!</title>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
	 crossorigin="anonymous">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


	<style>
		.movie-btn {
			background-color: #4CAF50;
			border: none;
			color: white;
			padding: 14px 20px;
			text-align: center;
			text-decoration: none;
			display: inline-block;
			font-size: 16px;
			border-radius: 5px;
			margin: 5px;
		}

		#gifCollection {
			float: left;
			background-color: slategray;
		}

		#formholder {
			background-color: slategray;
		}

		#initialMovieListButtons {
			background-color: slategray;
			margin-bottom: 20px;
		}

		body {
			background-color: slategray;
		}


		.gif {
			margin: 10px 10px 0px 0px;
			float: left;
		}

		p {
			text-align: center;
		}
	</style>
</head>

<body>

	<div id="initialMovieListButtons"></div>


	<div class="row">

		<div class="col-xs-9" id="gifCollection">

		</div>
		<div class="col-xs-3" id="formholder">
			<form id="addMovieForm">

				<h3>Add a Movie!:</h3>


				<input type="text" id="movieTitle">
				<br>
				<br>
				<input id="addMovie" type="submit" value="submit">

			</form>
		</div>
	</div>





	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script type="text/javascript">
		$('document').ready(function () {


			var movies = ["The Blues Brothers", "Friday", "Goodfellas", "Scrooged", "Bad Santa", "The Big Lebowski", "Four Rooms", "So I Married An Axe Murderer"];
			var apikey = "ljAoPP2wCtxvB68gzS9cDEf9jwTjHnV8";
			var movieTitle;




			function showButtons() {

				//clears div to avoid duplicate buttons
				$("#initialMovieListButtons").empty();

				//loops through our array to make a button for each movie
				for (var i = 0; i < movies.length; i++) {


					//creates a variable to store our button
					var topicbutton = $("<button>");

					topicbutton.addClass("movie-btn");
					topicbutton.attr("data-name", movies[i]);
					topicbutton.text(movies[i]);
					$("#initialMovieListButtons").append(topicbutton);

					console.log(movies[i]);


				}
			}

			//adding button once a movie is suggested
			$("#addMovie").on("click", function (event) {
				//stops page from refreshing
				event.preventDefault();
				//create a place for our input to go and make it look nice
				var movie = $("#movieTitle").val().trim();

				// Adding movie from the textbox to our array
				movies.push(movie);
				//uses array to show buttons
				showButtons();
				//test
				console.log(movies);
				//clears the input box for the next suggestion
				$("#movieTitle").val(" ");
			});



			//ajax call to queryURL 
			function displayPulledGifs() {

				var movie = $(this).attr("data-name");
				var queryURL = "http://api.giphy.com/v1/gifs/search?q=" + movie + "&api_key=ljAoPP2wCtxvB68gzS9cDEf9jwTjHnV8&limit=2";

				$.ajax({
					url: queryURL,
					method: "GET"
				}).then(function (response) {

					// from giphy api documentation 
					//javascript, jQuery 
					//var xhr = $.get("https://api.giphy.com/v1/gifs/search?q=ryan+gosling&api_key=jAoPP2wCtxvB68gzS9cDEf9jwTjHnV8&limit=5");
					//xhr.done(function (data) { console.log("success got data", data); });

					var apiData = response.data;
					console.log("success got data", response);

					// var rating = response.data.rating;
					// console.log(rating);


					//get image url, rating info, and display it with jquery
					//do it 9 times in a for loop
					for (var i = 0; i < apiData.length; i++) {


						//creates a div to hold the image and rating
						var gifHolder = $("<div class='gif'>");



						//creates a var to hold the image
						var movieGif = $("<img>");

						//creates a variable for the rating
						var rating = apiData[i].rating;
						console.log(rating);

						var ratingTag = $("<p>").text("Rating: " + rating);

						gifHolder.append(ratingTag);

						movieGif.attr("src", apiData[i].images.fixed_height.url);


						// this is the more generic movie gif description
						// movieGif.attr("alt", "movie gif");

						//this alt description actually changes with which movie button is pressed.  
						movieGif.attr("alt", movie + " image");


						gifHolder.append(movieGif);
						// $("#movieGifs").prepend(movieGif);
						// $("#rating").val(ratingTag);


						$("#gifCollection").prepend(gifHolder);

					}
				});

			}





			showButtons();
			$(document).on("click", ".movie-btn", displayPulledGifs);
		});

	</script>

</body>

</html>